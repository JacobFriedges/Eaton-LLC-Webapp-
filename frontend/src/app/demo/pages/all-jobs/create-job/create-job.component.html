<div class="container">
    <h2>Job Creator</h2>
  
    <form [formGroup]="jobForm">
      <ng-stepper #cdkStepper [linear]="true" class="custom-stepper">
        <!-- Step 1: Job Details -->
        <cdk-step [stepControl]="jobForm.controls['project']">
          <ng-template cdkStepLabel>
            <div class="step-bullet">1</div>
            <div class="step-title">Project Details</div>
          </ng-template>
          <div class="form-content">

            <!-- Input for Project Name -->
            <div class="form-group">
              <label>Project</label>
              <input type="text" formControlName="project" class="form-control">
            </div>

            <!-- Input for Prime Contractor -->
            <div class="form-group">
              <label>Prime Contractor</label>
              <input type="text" formControlName="primeContractor" class="form-control">
            </div>

            <!-- Input for Prime Contractor Project Number -->
            <div class="form-group">
              <label>Prime Contractor Project Number</label>
              <input type="text" formControlName="primeContractorProjectNumber" class="form-control">
            </div>

            <!-- Input for Invoiced Contractor -->
            <div class="form-group">
              <label>Invoiced Contractor</label>
              <select formControlName="contractorInvoice" class="form-control">
                <option value="primeContractor">Prime Contractor</option>
                <option value="other">Other</option>
              </select>
            </div>

            <!-- Conditional Input for "Other" Invoiced Contractor -->
            <div class="form-group" *ngIf="isOtherContractor">
              <label>New Invoiced Contractor</label>
              <input type="text" formControlName="newContractorInvoice" class="form-control" placeholder="Enter Invoiced Contractor Name">
            </div>

            <!-- Input for Invoiced Contractor Project Number -->
            <div class="form-group">
              <label>Invoiced Contractor Project Number</label>
              <select formControlName="contractorInvoiceProjectNumber" class="form-control">
                <option value="primeContractorProjectNumber">Prime Contractor Project Number</option>
                <option value="other">Other</option>
              </select>
            </div>

            <!-- Conditional Input for "Other" Contractor Project Number -->
            <div class="form-group" *ngIf="isOtherContractorProjectNumber">
              <label>New Invoiced Contractor Project Number</label>
              <input type="text" formControlName="newContractorInvoiceProjectNumber" class="form-control" placeholder="Enter Invoiced Contractor's Project Number">
            </div>

            <!-- Input for Prevailing or Non Prevailing -->
            <div class="form-group">
              <label>Prevailing or Non Prevailing</label>
              <select formControlName="prevailingOrNot" class="form-control">
                <option value="prevailing">Prevailing</option>
                <option value="nonPrevailing">Non Prevailing</option>
              </select>
            </div>

            <!-- Conditional Input for Non Prevailing -->
            <div class="form-group" *ngIf="isNonPrevailing">
              <label>SAP or SP Number</label>
              <input type="text" formControlName="sapOrSpNumber" class="form-control" placeholder="Enter SAP or SP Number">
            </div>

            <!-- Conditional Input for Prevailing -->
            <div class="form-group" *ngIf="isPrevailing">
              <label>Reporting Requirement</label>
              <input type="text" formControlName="reportRequirement" class="form-control" placeholder="Enter Reporting Requirement">

              <label>Contract Number</label>
              <input type="text" formControlName="contractNumber" class="form-control" placeholder="Enter Contract Number">

              <label>Project ID Number</label>
              <input type="text" formControlName="projectId" class="form-control" placeholder="Enter Project ID Number">

              <!-- Prevailing Wage Class Code Table -->
              <div class="mt-3">
                <h5>Prevailing Wage Class Codes</h5>
                <table class="table table-bordered w-100 dark-table" style="table-layout: auto;">
                  <thead>
                    <tr>
                      <th>Class Code</th>
                      <th>Base Rate</th>
                      <th>Fringe Rate</th>
                      <th>Total Standard Time Rate</th>
                      <th>Total Overtime Rate</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let classCode of ['602', '604', '607']; let i = index">
                      <td>
                        <input class="form-control" [value]="classCode" readonly>
                      </td>
                      <td>
                        <input class="form-control" [formControlName]="'baseRate' + i" placeholder="">
                      </td>
                      <td>
                        <input class="form-control" [formControlName]="'fringeRate' + i" placeholder="">
                      </td>
                      <td>
                        <input class="form-control" [formControlName]="'standardRate' + i" placeholder="">
                      </td>
                      <td>
                        <input class="form-control" [formControlName]="'overtimeRate' + i" placeholder="">
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="stepper-buttons">
            <button cdkStepperNext class="btn btn-primary">Next →</button>
          </div>
        </cdk-step>
  
        <!-- Step 2: Rate & Material -->
        <cdk-step [stepControl]="jobForm.controls['material']">
          <ng-template cdkStepLabel>
            <div class="step-bullet">2</div>
            <div class="step-title">Job Rate & Material</div>
          </ng-template>
          <div class="form-content">

            <!-- Input for Job Description -->
            <div class ="form-group">
              <label>Job Description</label>
              <input type="text" formControlName="jobDescription" class="form-control" placeholder="Enter a Job Description">
            </div>
            
            <!-- Input for Job Number / Code -->
            <div class ="form-group">
              <label>Job Number</label>
              <input type="text" formControlName="jobNumber" class="form-control" placeholder="Enter the Job or Phase Number">             
            </div>
            
            <!-- Input for Material To Be Moved -->
            <div class ="form-group">
              <label>Material</label>
              <input type="text" formControlName="material" class="form-control" placeholder="Enter the Material to be Moved">
            </div>

            <!-- Input for Material To Be Moved -->
            <div class ="form-group">
              <label>Number Of Different Truck Types</label>
              <input type="text" formControlName="numberTruckType" class="form-control" placeholder="Enter the Number of Different Truck Types Used">
            </div>

            <!-- Dynamically Rendered Truck Types -->
            <div class="form-section">
              <div formArrayName="truckTypes">
                <div *ngFor="let truckType of truckTypes.controls; let i = index" [formGroupName]="i" class="truck-type-form">
                  <h3>Truck Type {{ i + 1 }}</h3>
                  <div class="row">
                    <div class="form-group col-md-3">
                      <label for="truckTypeName-{{ i }}">Truck Type Name:</label>
                      <select id="truckTypeName-{{ i }}" formControlName="truckTypeName" type="text" class="form-control" >
                        <option value="belly">Belly</option>
                        <option value="side">Side</option>
                        <option value="end">End</option>
                        <option value="quint">Quint</option>
                        <option value="quad">Quad</option>
                        <option value="tri">Tri</option>
                      </select>
                    </div>
                    <div class="form-group col-md-3">
                      <label for="trucksNeeded-{{ i }}">Trucks Needed:</label>
                      <input id="trucksNeeded-{{ i }}" formControlName="trucksNeeded" type="number" min="0" class="form-control" />
                    </div>
                    <div class="form-group col-md-4">
                      <label for="truckInvoiceType-{{ i }}">Truck Invoice Type:</label>
                      <select id="truckInvoiceType-{{ i }}" formControlName="truckInvoiceType" class="form-control" >
                        <option value="weight">Weight</option>
                        <option value="load">Load</option>
                        <option value="hour">Hour</option>
                      </select>
                    </div>
                    <div class="form-group col-md-3">
                      <label for="truckRate-{{ i }}">Truck Rate ($):</label>
                      <input id="truckRate-{{ i }}" formControlName="truckRate" type="number" class="form-control" />
                    </div>
                    

                  </div>
                </div>
              </div>
            </div>     
          </div>
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
        </div>
        
        </cdk-step>
  
        <!-- Step 3: Date, Time, and Volume -->
        <cdk-step>
          <ng-template cdkStepLabel>
            <div class="step-bullet">3</div>
            <div class="step-title">Date, Time, and Volume</div>
          </ng-template>
          <div class="form-content">
            <label>Total Amount Ordered</label>
            <input type="number" formControlName="totalAmount" class="form-control">
        
            <label>Date Range</label>
            <input type="date" formControlName="dateRange" class="form-control">
        
            <label>Shift Start Time</label>
            <input type="time" formControlName="shiftStart" class="form-control">
        
            <label>Shift End Time</label>
            <input type="time" formControlName="shiftEnd" class="form-control">
        
            <label>Default Yard Buffer Time (Minutes)</label>
            <input type="number" formControlName="yardBufferTime" class="form-control">
          </div>
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
        </div>
        </cdk-step>
  
        <!-- Step 4: Dispatch Request -->
        <cdk-step>
          <ng-template cdkStepLabel>
            <div class="step-bullet">4</div>
            <div class="step-title">Dispatch Request</div>
          </ng-template>
          <div class="form-content">
            <label>Number of Trucks Needed</label>
            <input type="number" formControlName="trucksNeeded" class="form-control">
        
            <label>Truck Types</label>
            <input type="text" formControlName="truckTypes" class="form-control">
        
            <label>Daily Delivery Target</label>
            <input type="number" formControlName="dailyTarget" class="form-control">
          </div>
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
        </div>
        </cdk-step>
  
        <!-- Step 5: Loading & Unloading -->
        <cdk-step>
          <ng-template cdkStepLabel>
            <div class="step-bullet">5</div>
            <div class="step-title">Loading & Unloading</div>
          </ng-template>
          <div class="form-content">
            <label>Loading Address</label>
            <input type="text" formControlName="loadingAddress" class="form-control">
        
            <label>Unloading Address</label>
            <input type="text" formControlName="unloadingAddress" class="form-control">
          </div>
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
        </div>
        </cdk-step>
  
        <!-- Step 6: Additional Notes -->
        <cdk-step>
          <ng-template cdkStepLabel>
            <div class="step-bullet">6</div>
            <div class="step-title">Additional Notes</div>
          </ng-template>
          <div class="form-content">
            <label>Notes</label>
            <textarea formControlName="additionalNotes" class="form-control"></textarea>
          </div>
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button class="btn btn-success" (click)="submitJob()">Submit Job</button>
          </div>
        </cdk-step>
  
        <!-- Stepper Navigation Buttons -->
        <div class="d-flex justify-content-between mt-3">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
            <button *ngIf="cdkStepper.selectedIndex === 5" class="btn btn-success" (click)="submitJob()">Submit Job</button>
        </div>
      </ng-stepper>
    </form>
  </div>
  