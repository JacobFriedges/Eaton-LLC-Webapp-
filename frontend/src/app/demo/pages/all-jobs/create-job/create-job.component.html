<div class="container">
    <h2>Job Creator</h2>
  
    <form [formGroup]="jobForm">
      <ng-stepper #cdkStepper [linear]="true" class="custom-stepper">
        <!-- Step 1: Job Details -->
        <cdk-step [stepControl]="jobForm.controls['project']">
          <ng-template cdkStepLabel>
            <div class="step-bullet">1</div>
            <div class="step-title">Project Details</div>
          </ng-template>
          <div class="form-content">

            <!-- Input for Project Name -->
            <div class="form-group">
              <label>Project</label>
              <input type="text" formControlName="project" class="form-control">
            </div>

            <!-- Input for Prime Contractor -->
            <div class="form-group">
              <label>Prime Contractor</label>
              <input type="text" formControlName="primeContractor" class="form-control">
            </div>

            <!-- Input for Prime Contractor Project Number -->
            <div class="form-group">
              <label>Prime Contractor Project Number</label>
              <input type="text" formControlName="primeContractorProjectNumber" class="form-control">
            </div>

            <!-- Input for Invoiced Contractor -->
            <div class="form-group">
              <label>Invoiced Contractor</label>
              <select formControlName="contractorInvoice" class="form-control">
                <option value="primeContractor">Prime Contractor</option>
                <option value="other">Other</option>
              </select>
            </div>

            <!-- Conditional Input for "Other" Invoiced Contractor -->
            <div class="form-group" *ngIf="isOtherContractor">
              <label>New Invoiced Contractor</label>
              <input type="text" formControlName="newContractorInvoice" class="form-control" placeholder="Enter Invoiced Contractor Name">
            </div>

            <!-- Input for Invoiced Contractor Project Number -->
            <div class="form-group">
              <label>Invoiced Contractor Project Number</label>
              <select formControlName="contractorInvoiceProjectNumber" class="form-control">
                <option value="primeContractorProjectNumber">Prime Contractor Project Number</option>
                <option value="other">Other</option>
              </select>
            </div>

            <!-- Conditional Input for "Other" Contractor Project Number -->
            <div class="form-group" *ngIf="isOtherContractorProjectNumber">
              <label>New Invoiced Contractor Project Number</label>
              <input type="text" formControlName="newContractorInvoiceProjectNumber" class="form-control" placeholder="Enter Invoiced Contractor's Project Number">
            </div>

            <!-- Input for Prevailing or Non Prevailing -->
            <div class="form-group">
              <label>Prevailing or Non Prevailing</label>
              <select formControlName="prevailingOrNot" class="form-control">
                <option value="prevailing">Prevailing</option>
                <option value="nonPrevailing">Non Prevailing</option>
              </select>
            </div>

            <!-- Conditional Input for Non Prevailing -->
            <div class="form-group" *ngIf="isNonPrevailing">
              <label>SAP or SP Number</label>
              <input type="text" formControlName="sapOrSpNumber" class="form-control" placeholder="Enter SAP or SP Number">
            </div>

            <!-- Conditional Input for Prevailing -->
            <div class="form-group" *ngIf="isPrevailing">
              <label>Reporting Requirement</label>
              <input type="text" formControlName="reportRequirement" class="form-control" placeholder="Enter Reporting Requirement">

              <label>Contract Number</label>
              <input type="text" formControlName="contractNumber" class="form-control" placeholder="Enter Contract Number">

              <label>Project ID Number</label>
              <input type="text" formControlName="projectId" class="form-control" placeholder="Enter Project ID Number">

              <!-- Prevailing Wage Class Code Table -->
              <div class="mt-3">
                <h5>Prevailing Wage Class Codes</h5>
                <table class="table table-bordered w-100 dark-table" style="table-layout: auto;">
                  <thead>
                    <tr>
                      <th>Class Code</th>
                      <th>Base Rate</th>
                      <th>Fringe Rate</th>
                      <th>Total Standard Time Rate</th>
                      <th>Total Overtime Rate</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let classCode of ['602', '604', '607']; let i = index">
                      <td>
                        <input class="form-control" [value]="classCode" readonly>
                      </td>
                      <td>
                        <input class="form-control" [formControlName]="'baseRate' + i" placeholder="">
                      </td>
                      <td>
                        <input class="form-control" [formControlName]="'fringeRate' + i" placeholder="">
                      </td>
                      <td>
                        <input class="form-control" [formControlName]="'standardRate' + i" placeholder="">
                      </td>
                      <td>
                        <input class="form-control" [formControlName]="'overtimeRate' + i" placeholder="">
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="stepper-buttons">
            <button cdkStepperNext class="btn btn-primary">Next →</button>
          </div>
        </cdk-step>
  
        <!-- Step 2: Rate & Material -->
        <cdk-step [stepControl]="jobForm.controls['material']">
          <ng-template cdkStepLabel>
            <div class="step-bullet">2</div>
            <div class="step-title">Job Rate & Material</div>
          </ng-template>
          <div class="form-content">

            <!-- Input for Job Description -->
            <div class ="form-group">
              <label>Job Description</label>
              <input type="text" formControlName="jobDescription" class="form-control" placeholder="Enter a Job Description">
            </div>
            
            <!-- Input for Job Number / Code -->
            <div class ="form-group">
              <label>Job Number</label>
              <input type="text" formControlName="jobNumber" class="form-control" placeholder="Enter the Job or Phase Number">             
            </div>
            
            <!-- Input for Material To Be Moved -->
            <div class ="form-group">
              <label>Material</label>
              <input type="text" formControlName="material" class="form-control" placeholder="Enter the Material to be Moved">
            </div>

            <!-- Input for Truck Type(s) needed -->
            <div class="form-group row">
              <div class="col-sm-12">
                <label class="form-label">Please select the truck types needed</label>
                <div class="form-check" *ngFor="let type of availableTruckTypes">
                  <input 
                    class="form-check-input"
                    type="checkbox"
                    [value]="type"
                    (change)="onTruckTypeChange($event)">
                  <label class="form-check-label">
                    {{ type }}
                  </label>
                </div>

                <!-- Inputs for Rate and Unit per Selected Truck Type -->
                <div *ngFor="let group of truckTypes.controls; let i = index" [formGroupName]="i">
                  <label class="form-label mt-3"><strong>{{ group.value.type }}</strong> - Rate and Unit</label>
                  <div class="row">
                    <div class="col-md-6 mb-2">
                      <input 
                        type="number" 
                        class="form-control" 
                        formControlName="rate" 
                        placeholder="Enter rate ($)">
                    </div>
                    <div class="col-md-6 mb-2">
                      <select class="form-control" formControlName="unit">
                        <option value="">Select unit</option>
                        <option value="ton">Ton</option>
                        <option value="metric ton">Metric Ton</option>
                        <option value="pound">Pound</option>
                        <option value="cubic yard">Cubic Yard</option>
                        <option value="bushel">Bushel</option>
                        <option value="bag">Bag</option>
                        <option value="load">Load</option>
                        <option value="hour">Hour</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
        </div>
        
        </cdk-step>
  
        <!-- Step 3: Date, Time, and Volume -->
        <cdk-step>
          <ng-template cdkStepLabel>
            <div class="step-bullet">3</div>
            <div class="step-title">Date, Time, and Volume</div>
          </ng-template>
          
          <div class="form-content">
        
            <label>Date</label>
            <input type="date" formControlName="jobDate" class="form-control">
        
            <label>Shift Start Time</label>
            <input type="time" formControlName="shiftStart" class="form-control">
          </div>
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
        </div>
        </cdk-step>
  
        
  
        <!-- Step 5: Loading & Unloading -->
        <cdk-step>
          <ng-template cdkStepLabel>
            <div class="step-bullet">4</div>
            <div class="step-title">Loading & Unloading</div>
          </ng-template>

          <div class="form-content">
            <label>Loading Address</label>
            <input type="text" formControlName="loadingAddress" class="form-control">
          
            <div class="form-group">
              <label class="section-title">Loading Options</label>
              <div class="option-row" *ngFor="let option of loadingOptions">
                <span class="option-label">{{ option.label }}</span>
                <select class="option-select" [formControlName]="option.controlName">
                  <option value="">Optional</option>
                  <option value="required">Required</option>
                  <option value="hidden">Hidden</option>
                </select>
              </div>
            </div>
          
            <!-- ADD THIS SPACER HERE -->
            <br><br>
          
            <label>Unloading Address</label>
            <input type="text" formControlName="unloadingAddress" class="form-control">
          
            <div class="form-group">
              <label class="section-title">Unloading Options</label>
              <div class="option-row" *ngFor="let option of unloadingOptions">
                <span class="option-label">{{ option.label }}</span>
                <select class="option-select" [formControlName]="option.controlName">
                  <option value="">Optional</option>
                  <option value="required">Required</option>
                  <option value="hidden">Hidden</option>
                </select>
              </div>
            </div>
          </div>
          
          
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
        </div>
        </cdk-step>
  
        <!-- Step 6: Additional Notes -->
        <cdk-step>
          <ng-template cdkStepLabel>
            <div class="step-bullet">6</div>
            <div class="step-title">Additional Notes</div>
          </ng-template>
          <div class="form-content">
            <label>Notes</label>
            <textarea formControlName="additionalNotes" class="form-control"></textarea>
          </div>
          <div class="stepper-buttons">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button class="btn btn-success" (click)="submitJob()">Submit Job</button>
          </div>
        </cdk-step>
  
        <!-- Stepper Navigation Buttons -->
        <div class="d-flex justify-content-between mt-3">
            <button cdkStepperPrevious class="btn btn-secondary">← Previous</button>
            <button cdkStepperNext class="btn btn-primary">Next →</button>
            <button *ngIf="cdkStepper.selectedIndex === 5" class="btn btn-success" (click)="submitJob()">Submit Job</button>
        </div>
      </ng-stepper>
    </form>
  </div>
  